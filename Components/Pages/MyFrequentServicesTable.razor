@page "/my-frequent-services-table"
@using Microsoft.AspNetCore.Components.Web
@inject IJSRuntime JSRuntime

<PageTitle>My Frequent Azure Services - Table View</PageTitle>

<div class="container">
    <div class="back-nav">
        <a href="azure-services" class="back-btn">‚Üê Back to All Services</a>
        <a href="my-frequent-services" class="back-btn" style="margin-left: 10px;">üìã List View</a>
    </div>

    <header>
        <h1>My Frequent Azure Services - Table View</h1>
        <p class="subtitle">Quick access to your most used Azure resources in table format</p>
    </header>

    @foreach (var serviceSection in serviceSections)
    {
        <div class="service-section">
            <div class="section-title" style="cursor: pointer;" @onclick="() => ToggleSection(serviceSection.Type)">
                <div class="section-info">
                    <span class="section-icon">@(serviceSection.Icon)</span>
                    @serviceSection.Name
                    <span class="toggle-icon">@(serviceSection.IsExpanded ? "‚ñº" : "‚ñ∂")</span>
                </div>
                <button class="add-btn" @onclick="() => OpenAddModal(serviceSection.Type)" @onclick:stopPropagation="true">+ Add @serviceSection.AddButtonText</button>
            </div>
            <div class="table-container @(serviceSection.IsExpanded ? "" : "collapsed")">
                <table class="services-table">
                    <thead>
                        <tr>
                            @foreach (var header in serviceSection.TableHeaders)
                            {
                                <th>@header</th>
                            }
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var resource in serviceSection.Resources)
                        {
                            <tr @onclick="() => NavigateToResource(resource.Url)">
                                <td>
                                    <div class="table-service-name">
                                        <span class="table-service-icon">@resource.Icon</span>
                                        @resource.Name
                                        @if (!string.IsNullOrEmpty(resource.Tag))
                                        {
                                            <span class="table-tag @resource.Tag.ToLower()">@resource.Tag</span>
                                        }
                                    </div>
                                </td>
                                <td>@resource.Type</td>
                                <td>@resource.ResourceGroup</td>
                                <td>@resource.Location</td>
                                <td>@resource.TierOrRuntime</td>
                                @if (serviceSection.ShowExtraColumn)
                                {
                                    <td>
                                        @if (serviceSection.Type == "apimanagement" && !string.IsNullOrEmpty(resource.ExtraColumn))
                                        {
                                            <button type="button" class="table-btn dev-portal" @onclick="() => NavigateToDevPortal(resource)" @onclick:stopPropagation="true">Open Portal</button>
                                        }
                                        else
                                        {
                                            @resource.ExtraColumn
                                        }
                                    </td>
                                }
                                <td><span class="table-status @resource.StatusClass">@resource.Status</span></td>
                                <td>
                                    <div class="table-actions">
                                        <button type="button" class="table-btn view" @onclick="() => NavigateToResource(resource.Url)" @onclick:stopPropagation="true">View</button>
                                    </div>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>
            </div>
        </div>
    }
</div>

<!-- Add Resource Modal -->
<div class="modal @(showModal ? "show" : "")" style="display: @(showModal ? "block" : "none")">
    <div class="modal-content">
        <div class="modal-header">
            <h2 class="modal-title">@modalTitle</h2>
        </div>
        <EditForm Model="newResource" OnValidSubmit="HandleAddResource">
            <DataAnnotationsValidator />
            <div class="form-group">
                <label class="form-label">Resource Name</label>
                <InputText class="form-control" @bind-Value="newResource.Name" required />
                <ValidationMessage For="@(() => newResource.Name)" />
            </div>
            <div class="form-group">
                <label class="form-label">Resource Group</label>
                <InputText class="form-control" @bind-Value="newResource.ResourceGroup" required />
                <ValidationMessage For="@(() => newResource.ResourceGroup)" />
            </div>
            <div class="form-group">
                <label class="form-label">Location</label>
                <InputSelect class="form-control" @bind-Value="newResource.Location" required>
                    <option value="">Select Location</option>
                    <option value="East US">East US</option>
                    <option value="West US">West US</option>
                    <option value="Central US">Central US</option>
                    <option value="North Europe">North Europe</option>
                    <option value="West Europe">West Europe</option>
                </InputSelect>
                <ValidationMessage For="@(() => newResource.Location)" />
            </div>
            @if (showRuntimeField)
            {
                <div class="form-group">
                    <label class="form-label">Runtime</label>
                    <InputSelect class="form-control" @bind-Value="newResource.Runtime">
                        <option value="">Select Runtime</option>
                        <option value=".NET 6">.NET 6</option>
                        <option value=".NET 8">.NET 8</option>
                        <option value="Node.js 18">Node.js 18</option>
                        <option value="Python 3.9">Python 3.9</option>
                        <option value="Java 11">Java 11</option>
                    </InputSelect>
                </div>
            }
            <div class="modal-actions">
                <button type="button" class="btn-secondary" @onclick="CloseModal">Cancel</button>
                <button type="submit" class="btn-primary">Add Resource</button>
            </div>
        </EditForm>
    </div>
</div>

@code {
    private List<ServiceTableSection> serviceSections = new();
    private bool showModal = false;
    private bool showRuntimeField = false;
    private string modalTitle = "";
    private string currentServiceType = "";
    private NewResourceModel newResource = new();

    protected override void OnInitialized()
    {
        InitializeServiceSections();
    }

    private void InitializeServiceSections()
    {
        serviceSections = new List<ServiceTableSection>
        {
            new ServiceTableSection
            {
                Name = "API Management",
                Icon = "üîå",
                Type = "apimanagement",
                AddButtonText = "API Management",
                IsExpanded = true,
                ShowExtraColumn = true,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Tier", "Dev Portal", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "api-kohler-dev2",
                        Icon = "üîå",
                        Type = "API Management",
                        ResourceGroup = "GLOBAL-API-Management-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Developer Tier",
                        ExtraColumn = "Portal Available",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-api-management-dev-rg/providers/Microsoft.ApiManagement/service/api-kohler-dev2/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "api-kohler-test",
                        Icon = "üîå",
                        Type = "API Management",
                        ResourceGroup = "GLOBAL-API-Management-TEST-rg",
                        Location = "East US",
                        TierOrRuntime = "Developer Tier",
                        ExtraColumn = "Portal Available",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-TEST-rg/providers/Microsoft.ApiManagement/service/api-kohler-test/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "api-kohler-uat",
                        Icon = "üîå",
                        Type = "API Management",
                        ResourceGroup = "GLOBAL-API-Management-PRE-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "Premium Tier",
                        ExtraColumn = "Portal Available",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PRE-PROD-rg/providers/Microsoft.ApiManagement/service/api-kohler-uat/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "az-amer-prod-kohlerapim-apim",
                        Icon = "üîå",
                        Type = "API Management",
                        ResourceGroup = "az-amer-prod-kohlerapim-rg",
                        Location = "North Central US",
                        TierOrRuntime = "Premium Tier",
                        ExtraColumn = "Portal Available",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/az-amer-prod-kohlerapim-rg/providers/Microsoft.ApiManagement/service/az-amer-prod-kohlerapim-apim/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "az-amer-prod-kohlerapimdr-apim",
                        Icon = "üîå",
                        Type = "API Management",
                        ResourceGroup = "az-amer-prod-kohlerapimdr-rg",
                        Location = "West US",
                        TierOrRuntime = "Premium Tier",
                        ExtraColumn = "Portal Available",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dr",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/az-amer-prod-kohlerapimdr-rg/providers/Microsoft.ApiManagement/service/az-amer-prod-kohlerapimdr-apim/overview"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Logic Apps",
                Icon = "üîÑ",
                Type = "logicapps",
                AddButtonText = "Logic App",
                IsExpanded = false,
                ShowExtraColumn = true,
                TableHeaders = new List<string> { "Service Name", "Type", "Environment", "Resource Group", "Location", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "APIM-Extension-Logic-App",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "GLOBAL-API-Management-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "Production",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PROD-rg/providers/Microsoft.Web/sites/APIM-Extension-Logic-App/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "APIM-Extension-Logic-App-Dev",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "global-api-management-dev-rg",
                        Location = "Central US",
                        TierOrRuntime = "Development",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-api-management-dev-rg/providers/Microsoft.Web/sites/APIM-Extension-Logic-App-Dev/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "APIM-Extension-Logic-App-PreProd",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "GLOBAL-API-Management-PRE-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "UAT/PreProd",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PRE-PROD-rg/providers/Microsoft.Web/sites/APIM-Extension-Logic-App-PreProd/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "APIM-Extension-Logic-App-Test",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "GLOBAL-API-Management-TEST-rg",
                        Location = "Central US",
                        TierOrRuntime = "Test",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-TEST-rg/providers/Microsoft.Web/sites/APIM-Extension-Logic-App-Test/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "product-registration",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-Test-rg",
                        Location = "Central US",
                        TierOrRuntime = "Production",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-Test-rg/providers/Microsoft.Logic/workflows/product-registration/logicApp"
                    },
                    new TableResourceItem
                    {
                        Name = "product-registration",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Dev",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg/providers/Microsoft.Logic/workflows/product-registration/logicApp"
                    },
                    new TableResourceItem
                    {
                        Name = "salesforce-ecomm-logicapp-prod",
                        Icon = "üîÑ",
                        Type = "Logic App",
                        ResourceGroup = "rg-salesforce-prod",
                        Location = "East US",
                        TierOrRuntime = "Production",
                        Status = "Enabled",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/your-rg/providers/Microsoft.Logic/workflows/salesforce-ecomm-logicapp-prod"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Azure Functions",
                Icon = "‚ö°",
                Type = "functions",
                AddButtonText = "Function App",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Runtime", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "apim-services-func-dev",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-api-management-dev-rg",
                        Location = "Central US",
                        TierOrRuntime = ".NET 6",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-api-management-dev-rg/providers/Microsoft.Web/sites/apim-services-func-dev/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "apim-services-func-test",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-api-management-test-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/rg-development/providers/Microsoft.Web/sites/data-processor-func"
                    },
                    new TableResourceItem
                    {
                        Name = "apim-services-func-uat",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-api-management-pre-prod-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-api-management-pre-prod-rg/providers/Microsoft.Web/sites/apim-services-func-uat/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "apim-services-func-prod",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-api-management-prod-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-api-management-prod-rg/providers/Microsoft.Web/sites/apim-services-func-prod/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "asr-finder-dev",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-TEST-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-TEST-ASR-FINDER-rg/providers/Microsoft.Web/sites/asr-finder-dev/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "asr-finder-integration-qa",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-TEST-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-TEST-ASR-FINDER-rg/providers/Microsoft.Web/sites/asr-finder-integration-qa/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "asr-finder-integration-uat",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-TEST-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-TEST-ASR-FINDER-rg/providers/Microsoft.Web/sites/asr-finder-integration-uat/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "asr-finder-integration-prod",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-PROD-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-PROD-ASR-FINDER-rg/providers/Microsoft.Web/sites/asr-finder-integration-prod/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "commercetools-product-integrations-preprod",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "GLOBAL-COMMERCETOOLS-PREPROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-COMMERCETOOLS-PREPROD-rg/providers/Microsoft.Web/sites/commercetools-product-integrations-preprod/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "commercetools-product-integrations-qa",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "GLOBAL-COMMERCETOOLS-TEST-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-COMMERCETOOLS-TEST-rg/providers/Microsoft.Web/sites/commercetools-product-integrations-qa/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-aem-funcapp-prod",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-aem-prod-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-aem-prod-rg/providers/Microsoft.Web/sites/ecomm-aem-funcapp-prod/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-aem-funcapp-test",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-aem-test-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-aem-test-rg/providers/Microsoft.Web/sites/ecomm-aem-funcapp-test/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-aem-funcapp-uat",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "GLOBAL-AEM-STAGE-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-AEM-STAGE-rg/providers/Microsoft.Web/sites/ecomm-aem-funcapp-uat/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg/providers/Microsoft.Web/sites/ecomm-salesforce-middleware/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware-dev",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg/providers/Microsoft.Web/sites/ecomm-salesforce-middleware-dev/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware-prod",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "amer-ecomm-salesforce-service-prd-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/amer-ecomm-salesforce-service-prd-rg/providers/Microsoft.Web/sites/ecomm-salesforce-middleware-prod/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware-test",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "amer-ecomm-salesforce-service-test-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/amer-ecomm-salesforce-service-test-rg/providers/Microsoft.Web/sites/ecomm-salesforce-middleware-test/appServices"
                    },
                    new TableResourceItem
                    {
                        Name = "kohler-zip-download-service",
                        Icon = "‚ö°",
                        Type = "Function App",
                        ResourceGroup = "global-aem-test-rg",
                        Location = "Central US",
                        TierOrRuntime = "Python 3.9",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/global-aem-test-rg/providers/Microsoft.Web/sites/kohler-zip-download-service/appServices"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Key Vault",
                Icon = "üóùÔ∏è",
                Type = "keyvault",
                AddButtonText = "Key Vault",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Tier", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "apim-services-kv-dev",
                        Icon = "üóùÔ∏è",
                        Type = "Key vault",
                        ResourceGroup = "GLOBAL-API-Management-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Standard",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-DEV-rg/providers/Microsoft.KeyVault/vaults/apim-services-kv-dev/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "apim-services-kv-uat",
                        Icon = "üóùÔ∏è",
                        Type = "Key vault",
                        ResourceGroup = "GLOBAL-API-Management-PRE-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "Standard",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PRE-PROD-rg/providers/Microsoft.KeyVault/vaults/apim-services-kv-uat/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "vault-kohler-api-dev",
                        Icon = "üóùÔ∏è",
                        Type = "Key vault",
                        ResourceGroup = "GLOBAL-API-Management-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "Standard",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-DEV-rg/providers/Microsoft.KeyVault/vaults/vault-kohler-api-dev/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "vault-kohler-api-test",
                        Icon = "üóùÔ∏è",
                        Type = "Key vault",
                        ResourceGroup = "GLOBAL-API-Management-TEST-rg",
                        Location = "Central US",
                        TierOrRuntime = "Standard",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-TEST-rg/providers/Microsoft.KeyVault/vaults/vault-kohler-api-test/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "vault-kohler-api-uat",
                        Icon = "üóùÔ∏è",
                        Type = "Key vault",
                        ResourceGroup = "GLOBAL-API-Management-PRE-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "Standard",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PRE-PROD-rg/providers/Microsoft.KeyVault/vaults/vault-kohler-api-uat/overview"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Application Insights",
                Icon = "üìä",
                Type = "appinsights",
                AddButtonText = "Application Insights",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Tier", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "az-amer-prod-kohlerapim-appi",
                        Icon = "üìä",
                        Type = "App Insights",
                        ResourceGroup = "az-amer-prod-kohlerapimmonitoring-rg",
                        Location = "North Central US",
                        TierOrRuntime = "App Insights",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "prod",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/az-amer-prod-kohlerapimmonitoring-rg/providers/microsoft.insights/components/az-amer-prod-kohlerapim-appi/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-app-insight-test",
                        Icon = "üìä",
                        Type = "App Insights",
                        ResourceGroup = "GLOBAL-API-Management-TEST-rg",
                        Location = "Central US",
                        TierOrRuntime = "App Insights",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-TEST-rg/providers/microsoft.insights/components/ecomm-app-insight-test/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-apim-preprod",
                        Icon = "üìä",
                        Type = "App Insights",
                        ResourceGroup = "GLOBAL-API-Management-PRE-PROD-rg",
                        Location = "Central US",
                        TierOrRuntime = "App Insights",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/GLOBAL-API-Management-PRE-PROD-rg/providers/microsoft.insights/components/ecomm-apim-preprod/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware",
                        Icon = "üìä",
                        Type = "App Insights",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg",
                        Location = "Central US",
                        TierOrRuntime = "App Insights",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-DEV-rg/providers/microsoft.insights/components/ecomm-salesforce-middleware/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "ecomm-salesforce-middleware-test",
                        Icon = "üìä",
                        Type = "App Insights",
                        ResourceGroup = "AMER-ECOMM-SALESFORCE-SERVICE-Test-rg",
                        Location = "Central US",
                        TierOrRuntime = "App Insights",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "test",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-ECOMM-SALESFORCE-SERVICE-Test-rg/providers/microsoft.insights/components/ecomm-salesforce-middleware-test/overview"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Cosmos DB",
                Icon = "üåê",
                Type = "cosmosdb",
                AddButtonText = "Cosmos DB",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "API", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "az-amer-dev-asrfinder-cosmos",
                        Icon = "üåê",
                        Type = "Cosmos DB",
                        ResourceGroup = "AMER-TEST-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "SQL API",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-TEST-ASR-FINDER-rg/providers/Microsoft.DocumentDb/databaseAccounts/az-amer-dev-asrfinder-cosmos/overview"
                    },
                    new TableResourceItem
                    {
                        Name = "az-amer-uat-asrfinder-cosmos",
                        Icon = "üåê",
                        Type = "Cosmos DB",
                        ResourceGroup = "AMER-TEST-ASR-FINDER-rg",
                        Location = "Central US",
                        TierOrRuntime = "SQL API",
                        Status = "Online",
                        StatusClass = "running",
                        Tag = "uat",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/35166c0d-3c12-4f4c-8638-79d7248ae93f/resourceGroups/AMER-TEST-ASR-FINDER-rg/providers/Microsoft.DocumentDb/databaseAccounts/az-amer-uat-asrfinder-cosmos/overview"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "App Services",
                Icon = "üåê",
                Type = "appservices",
                AddButtonText = "App Service",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Runtime", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "my-webapp",
                        Icon = "üåê",
                        Type = "App Service",
                        ResourceGroup = "rg-web",
                        Location = "East US",
                        TierOrRuntime = "Node.js 18",
                        Status = "Running",
                        StatusClass = "running",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/rg-web/providers/Microsoft.Web/sites/my-webapp"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Storage Accounts",
                Icon = "üíæ",
                Type = "storage",
                AddButtonText = "Storage Account",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Performance", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "mystorageaccount001",
                        Icon = "üíæ",
                        Type = "Storage Account",
                        ResourceGroup = "rg-storage",
                        Location = "East US",
                        TierOrRuntime = "Standard LRS",
                        Status = "Active",
                        StatusClass = "running",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/rg-storage/providers/Microsoft.Storage/storageAccounts/mystorageaccount001"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Resource Groups",
                Icon = "üìÅ",
                Type = "resourcegroups",
                AddButtonText = "Resource Group",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Resource Group Name", "Type", "Subscription", "Location", "Resources", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "rg-production",
                        Icon = "üìÅ",
                        Type = "Resource Group",
                        ResourceGroup = "Primary Subscription",
                        Location = "East US",
                        TierOrRuntime = "12 Resources",
                        Status = "Active",
                        StatusClass = "running",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/rg-production"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Azure Data Factory",
                Icon = "üè≠",
                Type = "datafactory",
                AddButtonText = "Data Factory",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Version", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "az-amer-dev-hcm-adf",
                        Icon = "üè≠",
                        Type = "Data Factory V2",
                        ResourceGroup = "az-amer-dev-hcm-rg",
                        Location = "Central US",
                        TierOrRuntime = "V2",
                        Status = "Running",
                        StatusClass = "running",
                        Tag = "dev",
                        Url = "https://portal.azure.com/#@mykohler.onmicrosoft.com/resource/subscriptions/e4e37c2d-09d5-4584-9b5b-e4d389d8cd1b/resourceGroups/az-amer-dev-hcm-rg/providers/Microsoft.DataFactory/factories/az-amer-dev-hcm-adf/overview"
                    }
                }
            },
            new ServiceTableSection
            {
                Name = "Azure Cognitive Search",
                Icon = "üîç",
                Type = "cognitivesearch",
                AddButtonText = "Cognitive Search",
                IsExpanded = false,
                ShowExtraColumn = false,
                TableHeaders = new List<string> { "Service Name", "Type", "Resource Group", "Location", "Pricing Tier", "Status", "Actions" },
                Resources = new List<TableResourceItem>
                {
                    new TableResourceItem
                    {
                        Name = "my-search-service",
                        Icon = "üîç",
                        Type = "Search Service",
                        ResourceGroup = "rg-search",
                        Location = "East US",
                        TierOrRuntime = "Standard",
                        Status = "Running",
                        StatusClass = "running",
                        Url = "https://portal.azure.com/#@/resource/subscriptions/your-subscription/resourceGroups/rg-search/providers/Microsoft.Search/searchServices/my-search-service"
                    }
                }
            }
        };
    }

    private void ToggleSection(string sectionType)
    {
        var section = serviceSections.FirstOrDefault(s => s.Type == sectionType);
        if (section != null)
        {
            section.IsExpanded = !section.IsExpanded;
            StateHasChanged();
        }
    }

    private void OpenAddModal(string serviceType)
    {
        currentServiceType = serviceType;
        var section = serviceSections.FirstOrDefault(s => s.Type == serviceType);
        if (section != null)
        {
            modalTitle = $"Add New {section.AddButtonText}";
            showRuntimeField = serviceType == "functions" || serviceType == "appservices";
            newResource = new NewResourceModel();
            showModal = true;
        }
    }

    private void CloseModal()
    {
        showModal = false;
        newResource = new NewResourceModel();
    }

    private void HandleAddResource()
    {
        var section = serviceSections.FirstOrDefault(s => s.Type == currentServiceType);
        if (section != null)
        {
            var serviceConfig = GetServiceConfig(currentServiceType);
            
            var newResourceItem = new TableResourceItem
            {
                Name = newResource.Name,
                Icon = serviceConfig.Icon,
                Type = serviceConfig.Title,
                ResourceGroup = newResource.ResourceGroup,
                Location = newResource.Location,
                TierOrRuntime = GetTierOrRuntime(currentServiceType, newResource.Runtime),
                Status = GetDefaultStatus(currentServiceType),
                StatusClass = "running"
            };

            section.Resources.Add(newResourceItem);
        }

        CloseModal();
    }

    private async Task NavigateToResource(string? url)
    {
        if (!string.IsNullOrEmpty(url))
        {
            await JSRuntime.InvokeVoidAsync("window.open", url, "_blank");
        }
    }

    private async Task NavigateToDevPortal(TableResourceItem resource)
    {
        // For API Management services, construct the developer portal URL
        if (!string.IsNullOrEmpty(resource.Name))
        {
            // Typical Azure API Management developer portal URL pattern
            var devPortalUrl = $"https://{resource.Name}.developer.azure-api.net";
            await JSRuntime.InvokeVoidAsync("window.open", devPortalUrl, "_blank");
        }
    }

    private ServiceConfig GetServiceConfig(string serviceType)
    {
        var configs = new Dictionary<string, ServiceConfig>
        {
            ["functions"] = new ServiceConfig { Title = "Function App", Icon = "‚ö°" },
            ["appservices"] = new ServiceConfig { Title = "App Service", Icon = "üåê" },
            ["storage"] = new ServiceConfig { Title = "Storage Account", Icon = "üíæ" },
            ["cosmosdb"] = new ServiceConfig { Title = "Cosmos DB", Icon = "üåê" },
            ["apimanagement"] = new ServiceConfig { Title = "API Management", Icon = "üîå" },
            ["keyvault"] = new ServiceConfig { Title = "Key Vault", Icon = "üóùÔ∏è" },
            ["appinsights"] = new ServiceConfig { Title = "Application Insights", Icon = "üìä" }
        };

        return configs.GetValueOrDefault(serviceType, new ServiceConfig { Title = "Service", Icon = "üìã" });
    }

    private string GetTierOrRuntime(string serviceType, string runtime)
    {
        return serviceType switch
        {
            "functions" or "appservices" => string.IsNullOrEmpty(runtime) ? ".NET 6" : runtime,
            "storage" => "Standard LRS",
            "cosmosdb" => "SQL API",
            "apimanagement" => "Developer Tier",
            "keyvault" => "Standard",
            "appinsights" => "App Insights",
            _ => "Standard"
        };
    }

    private string GetDefaultStatus(string serviceType)
    {
        return serviceType switch
        {
            "storage" => "Active",
            "cosmosdb" or "apimanagement" or "appinsights" or "keyvault" => "Online",
            _ => "Running"
        };
    }

    public class ServiceTableSection
    {
        public string Name { get; set; } = "";
        public string Icon { get; set; } = "";
        public string Type { get; set; } = "";
        public string AddButtonText { get; set; } = "";
        public bool IsExpanded { get; set; } = false;
        public bool ShowExtraColumn { get; set; } = false;
        public List<string> TableHeaders { get; set; } = new();
        public List<TableResourceItem> Resources { get; set; } = new();
    }

    public class TableResourceItem
    {
        public string Name { get; set; } = "";
        public string Icon { get; set; } = "";
        public string Type { get; set; } = "";
        public string ResourceGroup { get; set; } = "";
        public string Location { get; set; } = "";
        public string TierOrRuntime { get; set; } = "";
        public string ExtraColumn { get; set; } = "";
        public string Status { get; set; } = "";
        public string StatusClass { get; set; } = "";
        public string? Tag { get; set; }
        public string? Url { get; set; }
    }

    public class ServiceConfig
    {
        public string Title { get; set; } = "";
        public string Icon { get; set; } = "";
    }

    public class NewResourceModel
    {
        public string Name { get; set; } = "";
        public string ResourceGroup { get; set; } = "";
        public string Location { get; set; } = "";
        public string Runtime { get; set; } = "";
    }
}